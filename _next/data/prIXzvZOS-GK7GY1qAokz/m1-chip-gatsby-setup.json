{"pageProps":{"frontmatter":{"title":"Setting update Gatsby Development on an M1 Mac Mini","meta":"A post providing context into setting up an M1 Mac for Gatsby development and 1 happy path to get up and running with Gatsby on a M1 Mac fast!","categories":["code","gatsby","javascript"],"date":"June 1, 2021","path":"/m1-chip-gatsby-setup"},"content":"<p>Setting up a new M1 Chip Mac for JavaScript development is straightforward as of June 1st, 2021!\nPreviously, I'd read about the new M1 Chip <a href=\"https://dev.to/alexandrudanpop/the-m1-mac-is-it-worth-it-for-devs-3fi5\">difficulties during setup and common apps that weren't supported</a>.</p>\n<p>This post will troubleshoot minor issues I had setting up <a href=\"https://www.gatsbyjs.com/\">Gatsby</a> to develop, write and publish this post on my new M1 Chip Macâ€”specifically issues I had with Node and Sharp.</p>\n<h2>Gatsby Dev Woes</h2>\n<p>After cloning a Gatsby repo, I attempted the setting Gatsby development to write this post as I'd done before.</p>\n<pre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"><button class=\"shiki-copy-button\" aria-label=\"Copy code\" data-copied=\"false\" title=\"Copy code\" onclick=\"const code = this.parentElement.querySelector(&#x27;code&#x27;).textContent; navigator.clipboard.writeText(code); this.setAttribute(&#x27;data-copied&#x27;, &#x27;true&#x27;); this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied!&#x27;); this.setAttribute(&#x27;title&#x27;, &#x27;Copied!&#x27;); setTimeout(() => { this.setAttribute(&#x27;data-copied&#x27;, &#x27;false&#x27;); this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy code&#x27;); this.setAttribute(&#x27;title&#x27;, &#x27;Copy code&#x27;); }, 2000);\"><svg class=\"copy-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect width=\"14\" height=\"14\" x=\"8\" y=\"8\" rx=\"2\" ry=\"2\"></rect><path d=\"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\"></path></svg><svg class=\"check-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M20 6 9 17l-5-5\"></path></svg></button><code><span class=\"line\"><span style=\"color:#E2657E;--shiki-dark:#E2657E\">nvm</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> i</span><span style=\"color:#000000;--shiki-dark:#B3D8E5\"> &#x26;&#x26; </span><span style=\"color:#E2657E;--shiki-dark:#E2657E\">yarn</span><span style=\"color:#000000;--shiki-dark:#B3D8E5\"> &#x26;&#x26; </span><span style=\"color:#E2657E;--shiki-dark:#E2657E\">yarn</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> develop</span></span></code></pre>\n<p>The chain of commands above led to a few errors in my terminal.</p>\n<p>First, I observed that if I wasn't using Node 16, NVM seemed to endlessly try and install <a href=\"https://github.com/nvm-sh/nvm/issues/2350\">Node 14</a>.\nTo solve this issue, I bumped the version of Node in my <code>.nvmrc</code> to <code>16</code> and everything worked fine.</p>\n<p>Second, during NPM node module installation, I encountered errors with \"pre-built or built binaries\". <a href=\"https://www.npmjs.com/package/sharp\">Sharp</a> is one of the node modules which was causing the error. Sharp uses pre-built binaries to do image compression.\nTo solve the \"pre-built or built binaries\" issues with Sharp, I Installed Homebrew and some Homebrew formulas. Then I removed some folders and re-build my Gatsby app which go everything running.</p>\n<h2>Homebrew setup</h2>\n<p><em>Maybe you haven't heard of <a href=\"https://brew.sh/\">Homebrew</a> or don't use it. If you have a particular reason not to use Homebrew setting up your M1 Chip Mac for Gatsby development might be a bit more <a href=\"https://github.com/lovell/sharp/issues/2460\">difficult</a>.</em></p>\n<hr>\n<p><em>Setting up Homebrew takes seconds. Read more about Homebrew <a href=\"https://brew.sh/\">here</a> to decide if you'd like to set it up on your computer.</em></p>\n<hr>\n<p>After setting up Homebrew, formulas must be installed for Sharp or other packages to work. These Homebrew formulas are for using npm packages that require built binaries. A quick browser search can provide more detail but here are few links to save time and gain context: <a href=\"https://github.com/lovell/sharp/issues/2460\">Can't compile under Apple Silicon M1 arm64</a>, <a href=\"https://github.com/lovell/sharp/issues/2588\">Mismatched x64 and ARM64 architectures on M1 Mac</a>, <a href=\"https://stackoverflow.com/questions/54409953/cant-install-sharp/56108335\">Can't install Sharp</a>. The following command installs the Homebrew formulas required for Sharp to work.</p>\n<p>Specificallly, I believe I had to install <a href=\"https://formulae.brew.sh/formula/vips\">Vips</a>:</p>\n<pre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"><button class=\"shiki-copy-button\" aria-label=\"Copy code\" data-copied=\"false\" title=\"Copy code\" onclick=\"const code = this.parentElement.querySelector(&#x27;code&#x27;).textContent; navigator.clipboard.writeText(code); this.setAttribute(&#x27;data-copied&#x27;, &#x27;true&#x27;); this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied!&#x27;); this.setAttribute(&#x27;title&#x27;, &#x27;Copied!&#x27;); setTimeout(() => { this.setAttribute(&#x27;data-copied&#x27;, &#x27;false&#x27;); this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy code&#x27;); this.setAttribute(&#x27;title&#x27;, &#x27;Copy code&#x27;); }, 2000);\"><svg class=\"copy-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect width=\"14\" height=\"14\" x=\"8\" y=\"8\" rx=\"2\" ry=\"2\"></rect><path d=\"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\"></path></svg><svg class=\"check-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M20 6 9 17l-5-5\"></path></svg></button><code><span class=\"line\"><span style=\"color:#E2657E;--shiki-dark:#E2657E\">brew</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> install</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> node</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> vips</span></span></code></pre>\n<h2>Ship it</h2>\n<p>After installing the necessary Homebrew formulas for Sharp to work, I needed to clear cached Gatsby folders and build the application fresh.</p>\n<p>To clear my Gatsby app, I ran:</p>\n<pre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"><button class=\"shiki-copy-button\" aria-label=\"Copy code\" data-copied=\"false\" title=\"Copy code\" onclick=\"const code = this.parentElement.querySelector(&#x27;code&#x27;).textContent; navigator.clipboard.writeText(code); this.setAttribute(&#x27;data-copied&#x27;, &#x27;true&#x27;); this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied!&#x27;); this.setAttribute(&#x27;title&#x27;, &#x27;Copied!&#x27;); setTimeout(() => { this.setAttribute(&#x27;data-copied&#x27;, &#x27;false&#x27;); this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy code&#x27;); this.setAttribute(&#x27;title&#x27;, &#x27;Copy code&#x27;); }, 2000);\"><svg class=\"copy-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect width=\"14\" height=\"14\" x=\"8\" y=\"8\" rx=\"2\" ry=\"2\"></rect><path d=\"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\"></path></svg><svg class=\"check-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M20 6 9 17l-5-5\"></path></svg></button><code><span class=\"line\"><span style=\"color:#E2657E;--shiki-dark:#E2657E\">rimraf</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> node_modules</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> .cache</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> public</span></span>\n<span class=\"line\"><span style=\"color:#6A9955;--shiki-dark:#6A9955\"># or if you don't have rimraf globally installed</span></span>\n<span class=\"line\"><span style=\"color:#E2657E;--shiki-dark:#E2657E\">rm</span><span style=\"color:#E2657E;--shiki-dark:#E2657E\"> -rf</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> node_modules</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> .cache</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> public</span></span></code></pre>\n<p>And then re-installed:</p>\n<pre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"><button class=\"shiki-copy-button\" aria-label=\"Copy code\" data-copied=\"false\" title=\"Copy code\" onclick=\"const code = this.parentElement.querySelector(&#x27;code&#x27;).textContent; navigator.clipboard.writeText(code); this.setAttribute(&#x27;data-copied&#x27;, &#x27;true&#x27;); this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied!&#x27;); this.setAttribute(&#x27;title&#x27;, &#x27;Copied!&#x27;); setTimeout(() => { this.setAttribute(&#x27;data-copied&#x27;, &#x27;false&#x27;); this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy code&#x27;); this.setAttribute(&#x27;title&#x27;, &#x27;Copy code&#x27;); }, 2000);\"><svg class=\"copy-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect width=\"14\" height=\"14\" x=\"8\" y=\"8\" rx=\"2\" ry=\"2\"></rect><path d=\"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\"></path></svg><svg class=\"check-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M20 6 9 17l-5-5\"></path></svg></button><code><span class=\"line\"><span style=\"color:#E2657E;--shiki-dark:#E2657E\">yarn</span></span>\n<span class=\"line\"><span style=\"color:#6A9955;--shiki-dark:#6A9955\"># or via npm</span></span>\n<span class=\"line\"><span style=\"color:#E2657E;--shiki-dark:#E2657E\">npm</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> i</span></span>\n<span class=\"line\"><span style=\"color:#6A9955;--shiki-dark:#6A9955\"># or via my current fav</span></span>\n<span class=\"line\"><span style=\"color:#E2657E;--shiki-dark:#E2657E\">pnpm</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> i</span></span></code></pre>\n<p>And then re-built my Gatsby app:</p>\n<pre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"><button class=\"shiki-copy-button\" aria-label=\"Copy code\" data-copied=\"false\" title=\"Copy code\" onclick=\"const code = this.parentElement.querySelector(&#x27;code&#x27;).textContent; navigator.clipboard.writeText(code); this.setAttribute(&#x27;data-copied&#x27;, &#x27;true&#x27;); this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied!&#x27;); this.setAttribute(&#x27;title&#x27;, &#x27;Copied!&#x27;); setTimeout(() => { this.setAttribute(&#x27;data-copied&#x27;, &#x27;false&#x27;); this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy code&#x27;); this.setAttribute(&#x27;title&#x27;, &#x27;Copy code&#x27;); }, 2000);\"><svg class=\"copy-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><rect width=\"14\" height=\"14\" x=\"8\" y=\"8\" rx=\"2\" ry=\"2\"></rect><path d=\"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2\"></path></svg><svg class=\"check-icon\" xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><path d=\"M20 6 9 17l-5-5\"></path></svg></button><code><span class=\"line\"><span style=\"color:#E2657E;--shiki-dark:#E2657E\">yarn</span><span style=\"color:#007CF0;--shiki-dark:#007CF0\"> start</span></span></code></pre>\n<h2>Final thoughts</h2>\n<p>M1 Macs are less expensive than Intel Macs because of <a href=\"https://www.theguardian.com/business/2021/mar/21/global-shortage-in-computer-chips-reaches-crisis-point\">Computer Chip Shortages</a>, currently. I was concerned my MI Mac Mini would slow my development down because of bugs. Thankfully, I've had relatively no issues!</p>\n<p>In this post, I hopefully provided some context into setting up an M1 Mac for Gatsby development and one <em>happy path</em> to get up and running with Gatsby on an M1 Mac fast!</p>","slug":"m1-chip-gatsby-setup"},"__N_SSG":true}