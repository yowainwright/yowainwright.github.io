{"pageProps":{"frontmatter":{"title":"Setting update Gatsby Development on an M1 Mac Mini","meta":"A post providing context into setting up an M1 Mac for Gatsby development and 1 happy path to get up and running with Gatsby on a M1 Mac fast!","categories":["code","gatsby","javascript"],"date":"June 1, 2021","path":"/m1-chip-gatsby-setup"},"content":"\nSetting up a new M1 Chip Mac for JavaScript development is straightforward as of June 1st, 2021!\nPreviously, I'd read about the new M1 Chip [difficulties during setup and common apps that weren't supported](https://dev.to/alexandrudanpop/the-m1-mac-is-it-worth-it-for-devs-3fi5).\n\nThis post will troubleshoot minor issues I had setting up [Gatsby](https://www.gatsbyjs.com/) to develop, write and publish this post on my new M1 Chip Macâ€”specifically issues I had with Node and Sharp.\n\n## Gatsby Dev Woes\n\nAfter cloning a Gatsby repo, I attempted the setting Gatsby development to write this post as I'd done before.\n\n```bash\nnvm i && yarn && yarn develop\n```\n\nThe chain of commands above led to a few errors in my terminal.\n\nFirst, I observed that if I wasn't using Node 16, NVM seemed to endlessly try and install [Node 14](https://github.com/nvm-sh/nvm/issues/2350).\nTo solve this issue, I bumped the version of Node in my `.nvmrc` to `16` and everything worked fine.\n\nSecond, during NPM node module installation, I encountered errors with \"pre-built or built binaries\". [Sharp](https://www.npmjs.com/package/sharp) is one of the node modules which was causing the error. Sharp uses pre-built binaries to do image compression.\nTo solve the  \"pre-built or built binaries\" issues with Sharp, I Installed Homebrew and some Homebrew formulas. Then I removed some folders and re-build my Gatsby app which go everything running.\n## Homebrew setup\n\n_Maybe you haven't heard of [Homebrew](https://brew.sh/) or don't use it. If you have a particular reason not to use Homebrew setting up your M1 Chip Mac for Gatsby development might be a bit more [difficult](https://github.com/lovell/sharp/issues/2460)._\n\n---\n\n_Setting up Homebrew takes seconds. Read more about Homebrew [here](https://brew.sh/) to decide if you'd like to set it up on your computer._\n\n---\n\nAfter setting up Homebrew, formulas must be installed for Sharp or other packages to work. These Homebrew formulas are for using npm packages that require built binaries. A quick browser search can provide more detail but here are few links to save time and gain context: [Can't compile under Apple Silicon M1 arm64](https://github.com/lovell/sharp/issues/2460), [Mismatched x64 and ARM64 architectures on M1 Mac](https://github.com/lovell/sharp/issues/2588), [Can't install Sharp](https://stackoverflow.com/questions/54409953/cant-install-sharp/56108335). The following command installs the Homebrew formulas required for Sharp to work.\n\nSpecificallly, I believe I had to install [Vips](https://formulae.brew.sh/formula/vips):\n\n```bash\nbrew install node vips\n```\n\n## Ship it\n\nAfter installing the necessary Homebrew formulas for Sharp to work, I needed to clear cached Gatsby folders and build the application fresh.\n\nTo clear my Gatsby app, I ran:\n\n```bash\nrimraf node_modules .cache public\n# or if you don't have rimraf globally installed\nrm -rf node_modules .cache public\n```\n\nAnd then re-installed:\n\n```bash\nyarn\n# or via npm\nnpm i\n# or via my current fav\npnpm i\n```\n\nAnd then re-built my Gatsby app:\n\n```bash\nyarn start\n```\n\n## Final thoughts\n\nM1 Macs are less expensive than Intel Macs because of [Computer Chip Shortages](https://www.theguardian.com/business/2021/mar/21/global-shortage-in-computer-chips-reaches-crisis-point), currently. I was concerned my MI Mac Mini would slow my development down because of bugs. Thankfully, I've had relatively no issues!\n\nIn this post, I hopefully provided some context into setting up an M1 Mac for Gatsby development and one _happy path_ to get up and running with Gatsby on an M1 Mac fast!\n","slug":"m1-chip-gatsby-setup"},"__N_SSG":true}