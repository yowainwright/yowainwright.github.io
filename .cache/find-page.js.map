{"version":3,"sources":["../../src/cache-dir/find-page.js"],"names":["pageCache","module","exports","pages","pathPrefix","trimmedPathname","pathname","slice","length","split","join","foundPage","some","page","matchPath","path","exact"],"mappings":";;AACA;;AAEA,IAAMA,YAAY,EAAlB,C,CAHA;;;AAKAC,OAAOC,OAAP,GAAiB,UAACC,KAAD;AAAA,MAAQC,UAAR;AAAA,SAA4B,oBAAY;AACvD;AACA,QAAIC,kBAAkBC,SAASC,KAAT,CAAeH,WAAWI;;AAEhD;AAFsB,KAAtB,CAGA,IAAIH,gBAAgBI,KAAhB,MAA2BD,MAA3B,GAAoC,CAAxC,EAA2C;AACzCH,wBAAkBA,gBAAgBI,KAAhB,MAA2BF,KAA3B,CAAiC,CAAjC,EAAoC,CAAC,CAArC,EAAwCG,IAAxC,IAAlB;AACD;;AAED,QAAIV,UAAUK,eAAV,CAAJ,EAAgC;AAC9B,aAAOL,UAAUK,eAAV,CAAP;AACD;;AAED,QAAIM,kBAAJ;AACA;AACA;AACAR,UAAMS,IAAN,CAAW,gBAAQ;AACjB,UAAIC,KAAKC,SAAT,EAAoB;AAClB;AACA,YACE,+BAAUT,eAAV,EAA2B,EAAEU,MAAMF,KAAKE,IAAb,EAA3B,KACA,+BAAUV,eAAV,EAA2B;AACzBU,gBAAMF,KAAKC;AADc,SAA3B,CAFF,EAKE;AACAH,sBAAYE,IAAZ;AACAb,oBAAUK,eAAV,IAA6BQ,IAA7B;AACA,iBAAO,IAAP;AACD;AACF,OAZD,MAYO;AACL,YACE,+BAAUR,eAAV,EAA2B;AACzBU,gBAAMF,KAAKE,IADc;AAEzBC,iBAAO;AAFkB,SAA3B,CADF,EAKE;AACAL,sBAAYE,IAAZ;AACAb,oBAAUK,eAAV,IAA6BQ,IAA7B;AACA,iBAAO,IAAP;AACD;AACF;;AAED,aAAO,KAAP;AACD,KA3BD;;AA6BA,WAAOF,SAAP;AACD,GA9CgB;AAAA,CAAjB","file":"find-page.js","sourcesContent":["// TODO add tests especially for handling prefixed links.\nimport { matchPath } from \"react-router-dom\"\n\nconst pageCache = {}\n\nmodule.exports = (pages, pathPrefix = ``) => pathname => {\n  // Remove the pathPrefix from the pathname.\n  let trimmedPathname = pathname.slice(pathPrefix.length)\n\n  // Remove any hashfragment\n  if (trimmedPathname.split(`#`).length > 1) {\n    trimmedPathname = trimmedPathname.split(`#`).slice(0, -1).join(``)\n  }\n\n  if (pageCache[trimmedPathname]) {\n    return pageCache[trimmedPathname]\n  }\n\n  let foundPage\n  // Array.prototype.find is not supported in IE so we use this somewhat odd\n  // work around.\n  pages.some(page => {\n    if (page.matchPath) {\n      // Try both the path and matchPath\n      if (\n        matchPath(trimmedPathname, { path: page.path }) ||\n        matchPath(trimmedPathname, {\n          path: page.matchPath,\n        })\n      ) {\n        foundPage = page\n        pageCache[trimmedPathname] = page\n        return true\n      }\n    } else {\n      if (\n        matchPath(trimmedPathname, {\n          path: page.path,\n          exact: true,\n        })\n      ) {\n        foundPage = page\n        pageCache[trimmedPathname] = page\n        return true\n      }\n    }\n\n    return false\n  })\n\n  return foundPage\n}\n"]}