<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><meta property="og:locale" content="en_US"/><link href="https://yowainwright.imgix.net/favicon.png" rel="icon"/><meta name="keywords" content="jeffry, wainwright, jeffry wainwright, code, programmer, artist, athlete, developer, engineer"/><meta name="theme-color" content="#007cf0"/><link rel="manifest" href="https://yowainwright.imgix.net/manifest.json"/><meta name="description" content="Jeffry.in is the daily changelog of Jeffry Wainwright, an engineer living in California."/><meta property="og:site_name" content="Jeffry.in"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="600"/><link rel="icon" href="/favicon.ico"/><link rel="preload" href="./_next/static/css/7de9686a62b5d21c.css" as="style"/><link href="https://yowainwright.imgix.net/apple-icon-120x120.png" rel="apple-touch-icon" itemProp="logo"/><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;display=swap" rel="stylesheet"/><link rel="stylesheet" href="./_next/static/css/7de9686a62b5d21c.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="./_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="./_next/static/chunks/webpack-78d035c7f6802744.js" defer=""></script><script src="./_next/static/chunks/framework-72e9ce56f027b06c.js" defer=""></script><script src="./_next/static/chunks/main-09f1b5966c02c5d1.js" defer=""></script><script src="./_next/static/chunks/pages/_app-b7233cc8d183138f.js" defer=""></script><script src="./_next/static/chunks/pages/%5Bslug%5D-69431874fc6dad03.js" defer=""></script><script src="./_next/static/zvK5iaqCsxA2YfawjG3SD/_buildManifest.js" defer=""></script><script src="./_next/static/zvK5iaqCsxA2YfawjG3SD/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="https://yowainwright.imgix.net/portraits/me-smiling.jpg?w=150&amp;h=150&amp;fit=crop&amp;auto=format"/><div id="__next"><nav id="site-nav" class="site-nav" role="navigation" itemType="http://schema.org/SiteNavigationElement"><section class="site-nav__container"><a class="logo" href="/"><h3 class="logo__title">j</h3></a><div class="site-nav__links-wrapper"><ul class="site-nav__items"><li class="site-nav__item site-nav__item--resume"><a class="site-nav__link site-nav__link--resume" href="/resume">Resume</a></li><li class="site-nav__item site-nav__item--archive"><a class="site-nav__link site-nav__link--archive" href="/archive">Archive</a></li><li class="site-nav__item site-nav__item--about"><a class="site-nav__link site-nav__link--about" href="/about">About</a></li></ul><button class="site-nav__toggle" title="Toggle Darkmode"><svg viewBox="0 0 24 24"><path d="M9.37 5.51c-.18.64-.27 1.31-.27 1.99 0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27C17.45 17.19 14.93 19 12 19c-3.86 0-7-3.14-7-7 0-2.93 1.81-5.45 4.37-6.49zM12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"></path></svg></button></div></section></nav><article class="post__article"><header class="post__header"><h1>Digging into Sinon Fake Server Methods</h1><time class="post__time">September 5, 2017</time></header><section class="post__section"><div class="post__container"><div class="post__content"><p><a href="http://sinonjs.org/">Sinon</a> is a powerful library used for stubbing functions, methods, xhr calls, and servers in JavaScript. The library and concept have confused me several times. I've found defining the interface to be challenging. Often, I realize that if the interface is challenging me, I need to rethink it.</p>
<p>In this post, I will explain a bit of Sinon for context and then dig into faking a server with Sinon.</p>
<hr>
<ul>
<li>Stubbing, in JavaScript, is the act of making a dummy function that acts like a real JavaScript Interface allowing the stubber to fully test the thing they're testing. In example, if your testing a method that gets <code>.user()</code> information</li>
<li>Interface, in regards to this post, is the way information is passed, changed, published between methods and functions. If information interface is not optimal, tests should be able to show that.</li>
</ul>
<h4>For this post, here's a stub example</h4>
<pre class="shiki shiki-themes theme-custom-light theme-custom-dark" style="background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5" tabindex="0"><code><span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6">let</span><span style="color:#007CF0;--shiki-dark:#007CF0"> server</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">// then later in code a value is assigned to the variable</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">server</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#007CF0;--shiki-dark:#007CF0"> sinon</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">fakeServer</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">create</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span></code></pre>
<h2>Why would developers stub a server?</h2>
<p>Engineers stub servers so that they can make fake requests to stubbed servers. The benefit of doing this is that the engineer doesn't need a real server and because they're not dependent on a real server, they can focus on testing whatever their code does that needs a server to test it.</p>
<h2>A specific example</h2>
<p>In the example below, an ajax request is being made with plain ole' JavaScript</p>
<pre class="shiki shiki-themes theme-custom-light theme-custom-dark" style="background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5" tabindex="0"><code><span class="line"><span style="color:#E194B5;--shiki-dark:#E194B5">export</span><span style="color:#E194B5;--shiki-dark:#E194B5"> default</span><span style="color:#569CD6;--shiki-dark:#569CD6"> function</span><span style="color:#E2657E;--shiki-dark:#E2657E"> getUser</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">url</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#007CF0;--shiki-dark:#007CF0">callbackInfo</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#FFD700;color:#FFD700">{</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6">  let</span><span style="color:#007CF0;--shiki-dark:#007CF0"> info</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#DA70D6;color:#DA70D6">{</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">    stuff:</span><span style="color:#E2657E;--shiki-dark:#E2657E"> null</span><span style="color:#000000;--shiki-dark:#B3D8E5">,</span></span>
<span class="line"><span style="color:#000000;--shiki-dark:#B3D8E5">  </span><span style="--shiki-dark:#DA70D6;color:#DA70D6">}</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6">  const</span><span style="color:#E2657E;--shiki-dark:#E2657E"> xhr</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#E194B5;--shiki-dark:#E194B5"> new</span><span style="color:#E2657E;--shiki-dark:#E2657E"> XMLHttpRequest</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  xhr</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">open</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'GET'</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#007CF0;--shiki-dark:#007CF0">url</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#E2657E;--shiki-dark:#E2657E">true</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  xhr</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">withCredentials</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#E2657E;--shiki-dark:#E2657E"> true</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">  // update `info` onload</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  xhr</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">addEventListener</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'load'</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="color:#569CD6;--shiki-dark:#569CD6">=</span><span style="color:#569CD6;--shiki-dark:#569CD6">></span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#179FFF;color:#179FFF">{</span></span>
<span class="line"><span style="color:#E194B5;--shiki-dark:#E194B5">    if</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">xhr</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">status</span><span style="color:#E194B5;--shiki-dark:#E194B5"> </span><span style="color:#E194B5;--shiki-dark:#E194B5">></span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8"> 400</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#FFD700;color:#FFD700">{</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">      console</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">warn</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'Some Warning'</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">      callbackInfo</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">info</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"><span style="color:#E194B5;--shiki-dark:#E194B5">      return</span></span>
<span class="line"><span style="color:#000000;--shiki-dark:#B3D8E5">    </span><span style="--shiki-dark:#FFD700;color:#FFD700">}</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6">    const</span><span style="color:#E2657E;--shiki-dark:#E2657E"> resp</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#E2657E;--shiki-dark:#E2657E"> JSON</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">parse</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">xhr</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">responseText</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6">    const</span><span style="color:#E2657E;--shiki-dark:#E2657E"> respinfo</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#007CF0;--shiki-dark:#007CF0"> resp</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">info</span><span style="color:#E194B5;--shiki-dark:#E194B5"> ||</span><span style="color:#E2657E;--shiki-dark:#E2657E"> null</span></span>
<span class="line"><span style="color:#E194B5;--shiki-dark:#E194B5">    if</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">respinfo</span><span style="color:#E194B5;--shiki-dark:#E194B5"> ===</span><span style="color:#E2657E;--shiki-dark:#E2657E"> null</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="color:#E194B5;--shiki-dark:#E194B5">return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">    // update info</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">    info</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#FFD700;color:#FFD700">{</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">      stuff:</span><span style="color:#007CF0;--shiki-dark:#007CF0"> respinfo</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">status</span><span style="color:#E194B5;--shiki-dark:#E194B5"> ||</span><span style="color:#E2657E;--shiki-dark:#E2657E"> null</span><span style="color:#000000;--shiki-dark:#B3D8E5">,</span></span>
<span class="line"><span style="color:#000000;--shiki-dark:#B3D8E5">    </span><span style="--shiki-dark:#FFD700;color:#FFD700">}</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    callbackInfo</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">info</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span>
<span class="line"><span style="color:#000000;--shiki-dark:#B3D8E5">  </span><span style="--shiki-dark:#179FFF;color:#179FFF">}</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  xhr</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">addEventListener</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'error'</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="color:#569CD6;--shiki-dark:#569CD6">=</span><span style="color:#569CD6;--shiki-dark:#569CD6">></span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#179FFF;color:#179FFF">{</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">    console</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">warn</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'Some Warning'</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    callbackInfo</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">info</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span>
<span class="line"><span style="color:#000000;--shiki-dark:#B3D8E5">  </span><span style="--shiki-dark:#179FFF;color:#179FFF">}</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  xhr</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">send</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"><span style="--shiki-dark:#FFD700;color:#FFD700">}</span></span></code></pre>
<p>For the code example above, there is an interface that expects to get information from an ajax request and provide information in response—a response being what comes back from the server.</p>
<h2>How to stub a server with Sinon</h2>
<p>In the example above:</p>
<ul>
<li>The xhr request waits for a load event.</li>
<li>If the response in above a 400, that means there is an error with the response, and the console should warn developers.</li>
<li>If the response is not above a 400, the request will receive a <code>{object}</code> with a <code>status</code>.</li>
<li>In a callback function, the xhr request will return the object <code>{info}</code>.</li>
<li>If there is an <code>error</code> instead of a load event, another warning should be added to the console.</li>
</ul>
<p>No, that there is an example and a bullet list of what's happening, Sinon can be used to stub a fake server so we can mock the scenarios of the function.</p>
<p>To do this, first, a stub server must be created.</p>
<pre class="shiki shiki-themes theme-custom-light theme-custom-dark" style="background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5" tabindex="0"><code><span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">server</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#007CF0;--shiki-dark:#007CF0"> sinon</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">fakeServer</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">create</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span></code></pre>
<p>It is beneficial to mock a successful API response</p>
<pre class="shiki shiki-themes theme-custom-light theme-custom-dark" style="background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5" tabindex="0"><code><span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">// fake api</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6">const</span><span style="color:#E2657E;--shiki-dark:#E2657E"> resp</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#007CF0;--shiki-dark:#007CF0"> '{"info": "stuff"}'</span></span></code></pre>
<p>Next, describe what the fake server should response with. This is done with a method provided by Sinon and arguments.</p>
<pre class="shiki shiki-themes theme-custom-light theme-custom-dark" style="background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5" tabindex="0"><code><span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">server</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">respondWith</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">url</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#007CF0;--shiki-dark:#007CF0">resp</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span></code></pre>
<p>Sinon's <code>respondWith</code> method is <em>what the server responds with</em>. It can take in 3 arguments, a method (function), a URL or part of a URL, and the anticipated response. The documentation leaves what the method can do a mistery so this blog post will just stick to what's clear: the URL, and the response. When the <code>respondWith</code> method is left to that stubbing out the rest of the fake server response is just a few steps.</p>
<p>The final step is, triggering the fake response.</p>
<pre class="shiki shiki-themes theme-custom-light theme-custom-dark" style="background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5" tabindex="0"><code><span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">server</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">respond</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span></code></pre>
<p>Altogether the stubbed server looks like this.</p>
<pre class="shiki shiki-themes theme-custom-light theme-custom-dark" style="background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5" tabindex="0"><code><span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">// define fake api success reponse</span></span>
<span class="line"><span style="color:#569CD6;--shiki-dark:#569CD6">const</span><span style="color:#E2657E;--shiki-dark:#E2657E"> resp</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#007CF0;--shiki-dark:#007CF0"> '{"info": "stuff"}'</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">// create the fake server</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">server</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#007CF0;--shiki-dark:#007CF0"> sinon</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">fakeServer</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">create</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">// declare what the fake server should respond with</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">server</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">respondWith</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">url</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#007CF0;--shiki-dark:#007CF0">resp</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">// declare the fake response</span></span></code></pre>
<h2>How to fully test a stubbed Sinon server</h2>
<p>Now that this post has gone through stubbing a Sinon server, it will go into how the stub can be used to test the three things that the example function above will require.</p>
<ul>
<li>Test a successful response</li>
<li>Test a failed response</li>
<li>Test a errant response</li>
</ul>
<h3>Testing a successful response</h3>
<pre class="shiki shiki-themes theme-custom-light theme-custom-dark" style="background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5" tabindex="0"><code><span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">// this post reference Mocha testing</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">it</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'provides `user` information with request success'</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#569CD6;--shiki-dark:#569CD6">function</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">done</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#DA70D6;color:#DA70D6">{</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">  // the done argument along with this.timeout acts waits for a response for 100ms</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  this</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">timeout</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8">100</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">  // create the fake Sinon server</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  server</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#007CF0;--shiki-dark:#007CF0"> sinon</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">fakeServer</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">create</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">  // define the end point and its response within args</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  server</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">respondWith</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">url</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#007CF0;--shiki-dark:#007CF0">resp</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">  getUser</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">url</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#569CD6;--shiki-dark:#569CD6">function</span><span style="color:#E2657E;--shiki-dark:#E2657E"> info</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#FFD700;color:#FFD700">{</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">    // define user interface</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">an</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'Object'</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">accountStatus</span><span style="color:#E194B5;--shiki-dark:#E194B5"> ===</span><span style="color:#007CF0;--shiki-dark:#007CF0"> 'registered'</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">true</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">loginState</span><span style="color:#E194B5;--shiki-dark:#E194B5"> ===</span><span style="color:#007CF0;--shiki-dark:#007CF0"> 'semi'</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">true</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">memberType</span><span style="color:#E194B5;--shiki-dark:#E194B5"> ===</span><span style="color:#007CF0;--shiki-dark:#007CF0"> '146216164134017374'</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">true</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">userID</span><span style="color:#E194B5;--shiki-dark:#E194B5"> ===</span><span style="color:#007CF0;--shiki-dark:#007CF0"> '75607431722225'</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">true</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    done</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"><span style="color:#000000;--shiki-dark:#B3D8E5">  </span><span style="--shiki-dark:#FFD700;color:#FFD700">}</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">  // invoke the fake Sinon server response</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  server</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">respond</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="--shiki-dark:#DA70D6;color:#DA70D6">}</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span></code></pre>
<h3>Testing a failed response</h3>
<pre class="shiki shiki-themes theme-custom-light theme-custom-dark" style="background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5" tabindex="0"><code><span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">it</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'provides `user` information with request success'</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="color:#569CD6;--shiki-dark:#569CD6">=</span><span style="color:#569CD6;--shiki-dark:#569CD6">></span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#DA70D6;color:#DA70D6">{</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">  // create the fake Sinon server</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  server</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#007CF0;--shiki-dark:#007CF0"> sinon</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">fakeServer</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">create</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="--shiki-dark:#FFD700;color:#FFD700">{</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="color:#007CF0;--shiki-dark:#007CF0">respondImmediately:</span><span style="color:#E2657E;--shiki-dark:#E2657E"> true</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#FFD700;color:#FFD700">}</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">  // because the server response immediately, invoking the response is not needed</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  server</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">respondWith</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'/test'</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#007CF0;--shiki-dark:#007CF0">resp</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">  getUser</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">url</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#569CD6;--shiki-dark:#569CD6">function</span><span style="color:#E2657E;--shiki-dark:#E2657E"> info</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#FFD700;color:#FFD700">{</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">    // define a null user interface</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">an</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'Object'</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">accountStatus</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">null</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">loginState</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">null</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">memberType</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">null</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">userID</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">null</span></span>
<span class="line"><span style="color:#000000;--shiki-dark:#B3D8E5">  </span><span style="--shiki-dark:#FFD700;color:#FFD700">}</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="--shiki-dark:#DA70D6;color:#DA70D6">}</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span></code></pre>
<h3>Testing an errant response</h3>
<pre class="shiki shiki-themes theme-custom-light theme-custom-dark" style="background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5" tabindex="0"><code><span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">it</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'provides null defaults with `user` request error'</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#569CD6;--shiki-dark:#569CD6">function</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#DA70D6;color:#DA70D6">{</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">  // invoke server immediately to enforce error response</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  server</span><span style="color:#E194B5;--shiki-dark:#E194B5"> =</span><span style="color:#007CF0;--shiki-dark:#007CF0"> sinon</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">fakeServer</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">create</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="--shiki-dark:#FFD700;color:#FFD700">{</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="color:#007CF0;--shiki-dark:#007CF0">respondImmediately:</span><span style="color:#E2657E;--shiki-dark:#E2657E"> true</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#FFD700;color:#FFD700">}</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="color:#007CF0;--shiki-dark:#007CF0">  server</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">respondWith</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'/test'</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#007CF0;--shiki-dark:#007CF0">resp</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="--shiki-dark:#FFD700;color:#FFD700">[</span><span style="color:#B5CEA8;--shiki-dark:#B5CEA8">404</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="--shiki-dark:#DA70D6;color:#DA70D6">{</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">}</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#007CF0;--shiki-dark:#007CF0">''</span><span style="--shiki-dark:#FFD700;color:#FFD700">]</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">  getUser</span><span style="--shiki-dark:#179FFF;color:#179FFF">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">url</span><span style="color:#000000;--shiki-dark:#B3D8E5">, </span><span style="color:#569CD6;--shiki-dark:#569CD6">function</span><span style="color:#E2657E;--shiki-dark:#E2657E"> info</span><span style="--shiki-dark:#FFD700;color:#FFD700">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span><span style="color:#000000;--shiki-dark:#B3D8E5"> </span><span style="--shiki-dark:#FFD700;color:#FFD700">{</span></span>
<span class="line"><span style="color:#6A9955;--shiki-dark:#6A9955">    // define null user interface</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#E2657E;--shiki-dark:#E2657E">an</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">'Object'</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">accountStatus</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">null</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">loginState</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">null</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">memberType</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">null</span></span>
<span class="line"><span style="color:#E2657E;--shiki-dark:#E2657E">    expect</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">(</span><span style="color:#007CF0;--shiki-dark:#007CF0">user</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">userID</span><span style="--shiki-dark:#DA70D6;color:#DA70D6">)</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">to</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">be</span><span style="color:#000000;--shiki-dark:#B3D8E5">.</span><span style="color:#007CF0;--shiki-dark:#007CF0">null</span></span>
<span class="line"><span style="color:#000000;--shiki-dark:#B3D8E5">  </span><span style="--shiki-dark:#FFD700;color:#FFD700">}</span><span style="--shiki-dark:#179FFF;color:#179FFF">)</span></span>
<span class="line"><span style="--shiki-dark:#DA70D6;color:#DA70D6">}</span><span style="--shiki-dark:#FFD700;color:#FFD700">)</span></span></code></pre>
<h2>Conclusion</h2>
<p>This post has described how to use Sinon's Fake Server to fully test an interface for an XHR request. XHR Requests can be mocked by Sinon easily with a general understanding of Sinon. After setting up a Mock that works for a product, similar tests can be copied and reused elsewhere. This is why Sinon's Fake Server is a powerful tool.</p>
<p>Please use Sinon and <a href="http://sinonjs.org/releases/v2.1.0/fake-xhr-and-server/">Sinon's Fake Server</a>. Let <a href="/issue">me</a> know if this post can be improved or if it helped.</p></div><div class="post__giscus"></div></div><aside class="aside"><div class="aside__meta"><header class="aside__header"><h3 class="aside__title">Digging into Sinon Fake Server Methods</h3></header><section class="share"><nav class="share__nav"><button class="share__button">Share Article Link</button></nav></section></div></aside></section></article><footer class="site-footer" role="contentinfo" itemType="http://schema.org/WPFooter"><section class="site-footer__wrapper site-footer__wrapper--main"><article class="site-footer__col site-footer__col--contact"><h3 class="site-footer__title">Contact</h3><address class="site-footer__address"><p class="site-footer__content">Happy to chat, learn, help!</p><p class="site-footer__content"><a href="mailto:yowainwright@gmail.com">yowainwright@gmail.com</a>, Los Angeles, CA</p></address></article><div class="site-footer__col site-footer__col site-footer__col--social"><h3 class="site-footer__title">Connect</h3><nav class="social-footer"><ul class="social-list"><li class="social-list__item social-list__item--showing"><a href="https://github.com/yowainwright" class="social-list__link">Github</a></li><li class="social-list__item social-list__item--showing"><a href="https://instagram.com/yowainwright" class="social-list__link">Instragram</a></li><li class="social-list__item social-list__item--showing"><a href="https://www.linkedin.com/in/jeffrywainwright/" class="social-list__link">LinkedIn</a></li></ul></nav></div><article class="site-footer__col site-footer__col--self"><h3 class="site-footer__title site-footer__title--self">About</h3><figure class="site-footer__figure"><img class="media--circular site-footer__image" src="https://yowainwright.imgix.net/portraits/me-smiling.jpg?w=150&amp;h=150&amp;fit=crop&amp;auto=format" height="100%" width="100%" alt="Me smiling with a beard"/><figcaption class="site-footer__caption"><a class="site-footer__link" href="/"><strong>jeffry.in</strong>, <!-- -->2025</a>, is the blog of<!-- --> <a class="site-footer__link" href="/about">Jeffry (Jeff) Wainwright</a>, a software engineer, person, living in Los Angeles.</figcaption></figure></article></section><section class="site-footer__wrapper site-footer__wrapper--last"><h3 class="site-footer__title site-footer__title--last"><a class="site-footer__link" href="/">jeffry.in</a>, <!-- -->2025</h3></section></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"Digging into Sinon Fake Server Methods","meta":"Digging into Sinon Fake Server Methods and how to use them.","categories":["javascript"],"date":"September 5, 2017","path":"/sinon-fake-server-methods"},"content":"\u003cp\u003e\u003ca href=\"http://sinonjs.org/\"\u003eSinon\u003c/a\u003e is a powerful library used for stubbing functions, methods, xhr calls, and servers in JavaScript. The library and concept have confused me several times. I've found defining the interface to be challenging. Often, I realize that if the interface is challenging me, I need to rethink it.\u003c/p\u003e\n\u003cp\u003eIn this post, I will explain a bit of Sinon for context and then dig into faking a server with Sinon.\u003c/p\u003e\n\u003chr\u003e\n\u003cul\u003e\n\u003cli\u003eStubbing, in JavaScript, is the act of making a dummy function that acts like a real JavaScript Interface allowing the stubber to fully test the thing they're testing. In example, if your testing a method that gets \u003ccode\u003e.user()\u003c/code\u003e information\u003c/li\u003e\n\u003cli\u003eInterface, in regards to this post, is the way information is passed, changed, published between methods and functions. If information interface is not optimal, tests should be able to show that.\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch4\u003eFor this post, here's a stub example\u003c/h4\u003e\n\u003cpre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003elet\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e server\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e// then later in code a value is assigned to the variable\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eserver\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e sinon\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003efakeServer\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ecreate\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eWhy would developers stub a server?\u003c/h2\u003e\n\u003cp\u003eEngineers stub servers so that they can make fake requests to stubbed servers. The benefit of doing this is that the engineer doesn't need a real server and because they're not dependent on a real server, they can focus on testing whatever their code does that needs a server to test it.\u003c/p\u003e\n\u003ch2\u003eA specific example\u003c/h2\u003e\n\u003cp\u003eIn the example below, an ajax request is being made with plain ole' JavaScript\u003c/p\u003e\n\u003cpre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003eexport\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e default\u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e getUser\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eurl\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ecallbackInfo\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e  let\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e info\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e    stuff:\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e null\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e  \u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e  const\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e xhr\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e XMLHttpRequest\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  xhr\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003eopen\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'GET'\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eurl\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003etrue\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  xhr\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ewithCredentials\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e true\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e  // update `info` onload\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  xhr\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003eaddEventListener\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'load'\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003exhr\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003estatus\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e \u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#B5CEA8;--shiki-dark:#B5CEA8\"\u003e 400\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e      console\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ewarn\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'Some Warning'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e      callbackInfo\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003einfo\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e      return\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e    \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e resp\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e JSON\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003eparse\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003exhr\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eresponseText\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e    const\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e respinfo\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e resp\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003einfo\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e ||\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e null\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003erespinfo\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e ===\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e null\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003ereturn\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e    // update info\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e    info\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e      stuff:\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e respinfo\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003estatus\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e ||\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e null\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e    \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    callbackInfo\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003einfo\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e  \u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e}\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  xhr\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003eaddEventListener\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'error'\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e    console\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ewarn\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'Some Warning'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    callbackInfo\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003einfo\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e  \u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e}\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  xhr\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003esend\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eFor the code example above, there is an interface that expects to get information from an ajax request and provide information in response—a response being what comes back from the server.\u003c/p\u003e\n\u003ch2\u003eHow to stub a server with Sinon\u003c/h2\u003e\n\u003cp\u003eIn the example above:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eThe xhr request waits for a load event.\u003c/li\u003e\n\u003cli\u003eIf the response in above a 400, that means there is an error with the response, and the console should warn developers.\u003c/li\u003e\n\u003cli\u003eIf the response is not above a 400, the request will receive a \u003ccode\u003e{object}\u003c/code\u003e with a \u003ccode\u003estatus\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eIn a callback function, the xhr request will return the object \u003ccode\u003e{info}\u003c/code\u003e.\u003c/li\u003e\n\u003cli\u003eIf there is an \u003ccode\u003eerror\u003c/code\u003e instead of a load event, another warning should be added to the console.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eNo, that there is an example and a bullet list of what's happening, Sinon can be used to stub a fake server so we can mock the scenarios of the function.\u003c/p\u003e\n\u003cp\u003eTo do this, first, a stub server must be created.\u003c/p\u003e\n\u003cpre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eserver\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e sinon\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003efakeServer\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ecreate\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIt is beneficial to mock a successful API response\u003c/p\u003e\n\u003cpre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e// fake api\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003econst\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e resp\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e '{\"info\": \"stuff\"}'\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNext, describe what the fake server should response with. This is done with a method provided by Sinon and arguments.\u003c/p\u003e\n\u003cpre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eserver\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003erespondWith\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eurl\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eresp\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eSinon's \u003ccode\u003erespondWith\u003c/code\u003e method is \u003cem\u003ewhat the server responds with\u003c/em\u003e. It can take in 3 arguments, a method (function), a URL or part of a URL, and the anticipated response. The documentation leaves what the method can do a mistery so this blog post will just stick to what's clear: the URL, and the response. When the \u003ccode\u003erespondWith\u003c/code\u003e method is left to that stubbing out the rest of the fake server response is just a few steps.\u003c/p\u003e\n\u003cp\u003eThe final step is, triggering the fake response.\u003c/p\u003e\n\u003cpre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eserver\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003erespond\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAltogether the stubbed server looks like this.\u003c/p\u003e\n\u003cpre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e// define fake api success reponse\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003econst\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e resp\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e '{\"info\": \"stuff\"}'\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e// create the fake server\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eserver\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e sinon\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003efakeServer\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ecreate\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e// declare what the fake server should respond with\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eserver\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003erespondWith\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eurl\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eresp\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e// declare the fake response\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eHow to fully test a stubbed Sinon server\u003c/h2\u003e\n\u003cp\u003eNow that this post has gone through stubbing a Sinon server, it will go into how the stub can be used to test the three things that the example function above will require.\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eTest a successful response\u003c/li\u003e\n\u003cli\u003eTest a failed response\u003c/li\u003e\n\u003cli\u003eTest a errant response\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eTesting a successful response\u003c/h3\u003e\n\u003cpre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e// this post reference Mocha testing\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003eit\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'provides `user` information with request success'\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003efunction\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003edone\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e  // the done argument along with this.timeout acts waits for a response for 100ms\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  this\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003etimeout\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#B5CEA8;--shiki-dark:#B5CEA8\"\u003e100\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e  // create the fake Sinon server\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  server\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e sinon\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003efakeServer\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ecreate\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e  // define the end point and its response within args\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  server\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003erespondWith\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eurl\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eresp\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e  getUser\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eurl\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e info\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e    // define user interface\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ean\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'Object'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eaccountStatus\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e ===\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e 'registered'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eloginState\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e ===\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e 'semi'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ememberType\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e ===\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e '146216164134017374'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euserID\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e ===\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e '75607431722225'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003etrue\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    done\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e  \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e}\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e  // invoke the fake Sinon server response\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  server\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003erespond\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e}\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eTesting a failed response\u003c/h3\u003e\n\u003cpre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003eit\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'provides `user` information with request success'\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e  // create the fake Sinon server\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  server\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e sinon\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003efakeServer\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ecreate\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003erespondImmediately:\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e true\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e}\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e  // because the server response immediately, invoking the response is not needed\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  server\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003erespondWith\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'/test'\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eresp\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e  getUser\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eurl\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e info\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e    // define a null user interface\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ean\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'Object'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eaccountStatus\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003enull\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eloginState\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003enull\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ememberType\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003enull\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euserID\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003enull\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e  \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e}\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e}\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eTesting an errant response\u003c/h3\u003e\n\u003cpre class=\"shiki shiki-themes theme-custom-light theme-custom-dark\" style=\"background-color:#f9f9f9;--shiki-dark-bg:#031030;color:#000000;--shiki-dark:#b3d8e5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003eit\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'provides null defaults with `user` request error'\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003efunction\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e  // invoke server immediately to enforce error response\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  server\u003c/span\u003e\u003cspan style=\"color:#E194B5;--shiki-dark:#E194B5\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e sinon\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003efakeServer\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ecreate\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003erespondImmediately:\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e true\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e}\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e  server\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003erespondWith\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'/test'\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eresp\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#B5CEA8;--shiki-dark:#B5CEA8\"\u003e404\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e{\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e}\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e''\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e]\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e  getUser\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eurl\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#569CD6;--shiki-dark:#569CD6\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e info\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A9955;--shiki-dark:#6A9955\"\u003e    // define null user interface\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003ean\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003e'Object'\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eaccountStatus\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003enull\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eloginState\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003enull\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ememberType\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003enull\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E2657E;--shiki-dark:#E2657E\"\u003e    expect\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euser\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003euserID\u003c/span\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003eto\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003ebe\u003c/span\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#007CF0;--shiki-dark:#007CF0\"\u003enull\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#000000;--shiki-dark:#B3D8E5\"\u003e  \u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e}\u003c/span\u003e\u003cspan style=\"--shiki-dark:#179FFF;color:#179FFF\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"--shiki-dark:#DA70D6;color:#DA70D6\"\u003e}\u003c/span\u003e\u003cspan style=\"--shiki-dark:#FFD700;color:#FFD700\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eConclusion\u003c/h2\u003e\n\u003cp\u003eThis post has described how to use Sinon's Fake Server to fully test an interface for an XHR request. XHR Requests can be mocked by Sinon easily with a general understanding of Sinon. After setting up a Mock that works for a product, similar tests can be copied and reused elsewhere. This is why Sinon's Fake Server is a powerful tool.\u003c/p\u003e\n\u003cp\u003ePlease use Sinon and \u003ca href=\"http://sinonjs.org/releases/v2.1.0/fake-xhr-and-server/\"\u003eSinon's Fake Server\u003c/a\u003e. Let \u003ca href=\"/issue\"\u003eme\u003c/a\u003e know if this post can be improved or if it helped.\u003c/p\u003e","slug":"sinon-fake-server-methods"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"sinon-fake-server-methods"},"buildId":"zvK5iaqCsxA2YfawjG3SD","assetPrefix":".","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>