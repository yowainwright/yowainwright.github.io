<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8" data-next-head=""/><meta name="viewport" content="width=device-width" data-next-head=""/><meta property="og:locale" content="en_US"/><link href="https://yowainwright.imgix.net/favicon.png" rel="icon"/><meta name="keywords" content="jeffry, wainwright, jeffry wainwright, code, programmer, artist, athlete, developer, engineer"/><meta name="theme-color" content="#007cf0"/><link rel="manifest" href="https://yowainwright.imgix.net/manifest.json"/><meta name="description" content="Jeffry.in is the daily changelog of Jeffry Wainwright, an engineer living in California."/><meta property="og:site_name" content="Jeffry.in"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="600"/><link rel="icon" href="/favicon.ico"/><link rel="preload" href="./_next/static/css/9f5ef1230fc99141.css" as="style"/><link href="https://yowainwright.imgix.net/apple-icon-120x120.png" rel="apple-touch-icon" itemProp="logo"/><link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;display=swap" rel="stylesheet"/><link rel="stylesheet" href="./_next/static/css/9f5ef1230fc99141.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" noModule="" src="./_next/static/chunks/polyfills-42372ed130431b0a.js"></script><script src="./_next/static/chunks/webpack-e2a2553142c1dc0b.js" defer=""></script><script src="./_next/static/chunks/framework-7efd275063302d6c.js" defer=""></script><script src="./_next/static/chunks/main-4f5f14e533e48440.js" defer=""></script><script src="./_next/static/chunks/pages/_app-a6627fd93731ea2b.js" defer=""></script><script src="./_next/static/chunks/pages/%5Bslug%5D-6c35f1cdbf42c7e1.js" defer=""></script><script src="./_next/static/jrpvR4j_iVgWgcGavtFzw/_buildManifest.js" defer=""></script><script src="./_next/static/jrpvR4j_iVgWgcGavtFzw/_ssgManifest.js" defer=""></script></head><body><link rel="preload" as="image" href="https://yowainwright.imgix.net/portraits/me-smiling.jpg?w=150&amp;h=150&amp;fit=crop&amp;auto=format"/><div id="__next"><nav id="site-nav" class="site-nav" role="navigation" itemType="http://schema.org/SiteNavigationElement"><section class="site-nav__container"><a class="logo" href="/"><h3 class="logo__title">j</h3></a><div class="site-nav__links-wrapper"><ul class="site-nav__items"><li class="site-nav__item site-nav__item--resume"><a class="site-nav__link site-nav__link--resume" href="/resume">Resume</a></li><li class="site-nav__item site-nav__item--archive"><a class="site-nav__link site-nav__link--archive" href="/archive">Archive</a></li><li class="site-nav__item site-nav__item--about"><a class="site-nav__link site-nav__link--about" href="/about">About</a></li></ul><button class="site-nav__toggle" title="Toggle Darkmode"><svg viewBox="0 0 24 24"><path d="M9.37 5.51c-.18.64-.27 1.31-.27 1.99 0 4.08 3.32 7.4 7.4 7.4.68 0 1.35-.09 1.99-.27C17.45 17.19 14.93 19 12 19c-3.86 0-7-3.14-7-7 0-2.93 1.81-5.45 4.37-6.49zM12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"></path></svg></button></div></section></nav><article class="post__article"><header class="post__header"><h1>Document Cookies Are a Useful Tool With A Simple API With Some Nunaces</h1><time class="post__time">February 5, 2022</time></header><section class="post__section"><div class="post__container"><div class="post__content"><p><a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie">Document Cookie</a> is a part of the HTML Document. It's used on many, if not most, websites to store data.
Although, <code>document.cookie</code> is a string, there are subtle nuances to its API which can be misunderstood.
In this article, these nuances are explored in <em>just enough</em> detail to, hopefully, make <code>document.cookie</code> even more understandable.</p>
<h2>The Basics of Document Cookie</h2>
<p>Cookies can be created or referenced via the <code>document.cookie</code> property.</p>
<p>To create a cookie, all that is needed is something very simple.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span> <span class="token operator">=</span> <span class="token string">'&#x3C;key>=&#x3C;value>;'</span><span class="token punctuation">;</span>
</span></code></pre>
<p>Reading cookies is very simple as well.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword">const</span> cookies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlSearchParams</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span><span class="token punctuation">.</span><span class="token method function property-access">replaceAll</span><span class="token punctuation">(</span><span class="token string">'; '</span><span class="token punctuation">,</span> <span class="token string">'&#x26;'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">cookies<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'&#x3C;key>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span></code></pre>
<h2>Cookie Attributes Are Write Only (Nuance 1)</h2>
<p>After reading "The Basics of Document Cookie" section above, Cookies are incredibly simple to understand.
However, if viewing <a href="https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie">MDN's</a> description of <code>document.cookie</code>, you'll notice attributes can be added to a cookie to control its behavior.
This concept is easy to understand. However, when viewing the API for adding attributes, it's slightly more confusing.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span> <span class="token operator">=</span> <span class="token string">'&#x3C;key1>=value1; expires=&#x3C;date1>; path=&#x3C;path>; domain=&#x3C;domain>; secure; httponly'</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span> <span class="token operator">=</span> <span class="token string">'&#x3C;key2>=value2; expires=&#x3C;dat2>; path=&#x3C;path>;secure; httponly'</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token keyword">const</span> cookies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlSearchParams</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token known-class-name class-name">Object</span><span class="token punctuation">.</span><span class="token method function property-access">fromEntries</span><span class="token punctuation">(</span>cookies<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// { key1: 'value1', key2: 'value2' }</span>
</span></code></pre>
<h3>Code Observations</h3>
<ul>
<li>When reading the cookie output, all attributes are removed</li>
<li>Each cookie only has an accessible <code>key</code> and <code>value</code></li>
</ul>
<h3>Browser Observation</h3>
<ul>
<li>Cookie attributes can be viewed in the browser only!</li>
</ul>
<hr>
<h2>Cookie Updates (Nuance 2)</h2>
<p>Hint, a Cookie cannot be updated. It can only be re-written!
The good news is that because a cookie is only a string containing a key and value separated by a <code>=</code>, it is easy to find a replace with code.</p>
<p>Lets see this in in action!</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token keyword">const</span> cookies <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UrlSearchParams</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// '&#x3C;key1>=&#x3C;value`>;&#x3C;key2>=&#x3C;value2>;'</span>
</span><span class="code-line">cookies<span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token string">'&#x3C;key>'</span><span class="token punctuation">,</span> <span class="token string">'&#x3C;value>'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token comment">// note: when adding attributes the code  to update a cookie is slightly more complex</span>
</span></code></pre>
<h3>Code Observation</h3>
<ul>
<li>Cookies can't be updated. They can be re-written!</li>
<li>It is important to remember when re-writing a cookie to set necessary attributes!</li>
<li>It is important when designing the tech spec of a cookie to plan for attributes being write-only!</li>
</ul>
<h3>Browser Obverations</h3>
<ul>
<li>When viewing <code>cookies</code> assigned to <code>document.cookie</code> in a string, <code>attributes</code> are removed</li>
<li>Cookie key and value pairs are separated by a <code>=</code> within the <code>cookies</code> string.</li>
<li>Cookies are separated by a <code>;</code> with the <code>cookies</code> string</li>
</ul>
<hr>
<h2>Adding Multiple Cookies (Nuance 3)</h2>
<p>When retrieving cookies, executing <code>console.log(document.cookie)</code>  will print all of the cookies on the document as key value pairs. In that same space, it isn’t far fetched to think multiple cookies could be added the same way—<code>document.cookie='foo=bar; biz=baz;'</code>. However, that could will only assign the first cookie.</p>
<p>To add multiple cookies, each cookie must be added in a separate <code>document.cookie</code> assignment like the code block below.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line">  <span class="token punctuation">[</span><span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'bar'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'biz'</span><span class="token punctuation">,</span> <span class="token literal-property property">value</span><span class="token operator">:</span> <span class="token string">'baz'</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token method function property-access">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> key<span class="token punctuation">,</span> value <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=></span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>value<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">;</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</span><span class="code-line">  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span><span class="token punctuation">;</span> <span class="token comment">// 'foo=bar; biz=baz;'</span>
</span></code></pre>
<h3>Code Observation</h3>
<ul>
<li>Add cookies one at a time with the <code>document.cookie="&#x3C;key>=&#x3C;value>;"</code> assignment</li>
<li>Read cookies all at the same time by logging <code>document.cookie</code></li>
<li>Each cookie must be added by assigning a key value pair to <code>document.cookie</code></li>
</ul>
<h2>Reading Multiple Added Cookies (Nuance 4)</h2>
<p>When assigning a cookie, attributes are added with the same value as the key and value pair <code>=</code>, and <code>;</code>.
Weirdly, when retrieving cookies, each cookie represented by a key and value pair is also seperated by a <code>=</code>, and a <code>;</code>.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line"><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span> <span class="token operator">=</span> <span class="token string">'&#x3C;key1>=&#x3C;value1>; expires=&#x3C;date1>; path=&#x3C;path>; domain=&#x3C;domain>; secure; httponly'</span><span class="token punctuation">;</span>
</span><span class="code-line"><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span><span class="token punctuation">;</span> <span class="token comment">// '&#x3C;key1>=&#x3C;value1>;'</span>
</span></code></pre>
<h3>Code Observation</h3>
<ul>
<li>Don't worry about creating a cookie string with attributes and not being able to filter it among cookies and attributes!</li>
<li>Do worry about writing tech spec which accounts for expires to only be re-written, not updated!</li>
<li>Remember cookie keys are are unique, in that if you assign a cookie with the same key, it will overwrite the other cookie!</li>
</ul>
<h2>Deleting Cookies (Nuance 5)</h2>
<p>Deleting cookies is more complicated than expected. In order to delete the cookie, it must be assigned to no value as well as have its <code>Max-age</code> set to <code>-1</code>. It looks like this <code>document.cookie="foo=; Max-age=-1;";</code> . There is much discussion on Stackoverflow and the internet on the best way to delete cookies. Often the use of the setting the <code>expires</code> attribute to a date in the past is mentioned. However, defining a historical date seems more complex that setting a the Max-age to <code>-1</code>.</p>
<pre class="language-javascript"><code class="language-javascript code-highlight"><span class="code-line">  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span> <span class="token operator">=</span> <span class="token string">'foo=bar;'</span><span class="token punctuation">;</span> <span class="token comment">// foo=bar</span>
</span><span class="code-line">  <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token property-access">cookie</span> <span class="token operator">=</span> <span class="token string">'foo=; Max-age=-1;'</span><span class="token punctuation">;</span> <span class="token comment">// empty</span>
</span></code></pre>
<h3>Code Observation</h3>
<ul>
<li>Delete cookies by assigning the cookie value to nothing and setting the Max-age or expires</li>
<li><code>Max-age</code> looks like a cleaner way to delete cookies vs <code>expires</code></li>
<li>Deleting cookies is can only be done 1 at a time, just like adding cookies</li>
</ul>
<h3>Browser Observations</h3>
<ul>
<li>If you only set the cookie value to empty (<code>document.cookie = "foo=;";</code>) (and don't set a Max-age or expires), the cookie will still display in the browser, but without value</li>
<li>If you set the cookie value to empty and set the max-age to -1, the cookie will not display in the browser and will be deleted completely (<code>document.cookie = "foo=;max-age=-1;";</code>)</li>
</ul>
<h2>Final thoughts</h2>
<p>Cookies are a very simple useful way to store data.
The fact that they are write-only and can't be updated is important to understand.
Once those 2 points are understood, using cookies should be fun and generally easy.
Lastely, attributes are valuable for managing cookie behavior and keeping them secure!
Just remember they're only viewable in a browser's dev tools.</p>
<hr>
<p>Before writing this post, I did get caught up in the nuances I have tried to describe in this article.
I always used <a href="https://github.com/js-cookie/js-cookie">js-cookie</a> or similar so the nuances of <code>document.cookie</code> were hidden.
I wrote this simple utility, <a href="https://github.com/yowainwright/mini-cookies">mini-cookies</a> with 0 dependencies to abstract these nuaces—but in a very mimimal way.
Please reach out if you have suggestions!</p>
<p>Happy Hacking!</p></div><div class="post__giscus"></div></div><aside class="aside"><div class="aside__meta"><header class="aside__header"><h3 class="aside__title">Document Cookies Are a Useful Tool With A Simple API With Some Nunaces</h3></header><section class="share"><nav class="share__nav"><button class="share__button">Share Article Link</button></nav></section></div></aside></section></article><footer class="site-footer" role="contentinfo" itemType="http://schema.org/WPFooter"><section class="site-footer__wrapper site-footer__wrapper--main"><article class="site-footer__col site-footer__col--contact"><h3 class="site-footer__title">Contact</h3><address class="site-footer__address"><p class="site-footer__content">Happy to chat, learn, help!</p><p class="site-footer__content"><a href="mailto:yowainwright@gmail.com">yowainwright@gmail.com</a>, Los Angeles, CA</p></address></article><div class="site-footer__col site-footer__col site-footer__col--social"><h3 class="site-footer__title">Connect</h3><nav class="social-footer"><ul class="social-list"><li class="social-list__item social-list__item--showing"><a href="https://github.com/yowainwright" class="social-list__link">Github</a></li><li class="social-list__item social-list__item--showing"><a href="https://instagram.com/yowainwright" class="social-list__link">Instragram</a></li><li class="social-list__item social-list__item--showing"><a href="https://www.linkedin.com/in/jeffrywainwright/" class="social-list__link">LinkedIn</a></li></ul></nav></div><article class="site-footer__col site-footer__col--self"><h3 class="site-footer__title site-footer__title--self">About</h3><figure class="site-footer__figure"><img class="media--circular site-footer__image" src="https://yowainwright.imgix.net/portraits/me-smiling.jpg?w=150&amp;h=150&amp;fit=crop&amp;auto=format" height="100%" width="100%" alt="Me smiling with a beard"/><figcaption class="site-footer__caption"><a class="site-footer__link" href="/"><strong>jeffry.in</strong>, <!-- -->2024</a>, is the blog of<!-- --> <a class="site-footer__link" href="/about">Jeffry (Jeff) Wainwright</a>, a software engineer, person, living in Los Angeles.</figcaption></figure></article></section><section class="site-footer__wrapper site-footer__wrapper--last"><h3 class="site-footer__title site-footer__title--last"><a class="site-footer__link" href="/">jeffry.in</a>, <!-- -->2024</h3></section></footer></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"title":"Document Cookies Are a Useful Tool With A Simple API With Some Nunaces","meta":"This brief artice covers nuances of document.cookie and how to use it to store and access data.","categories":["code","javascript","html"],"date":"February 5, 2022","path":"/document-cookie-nuances"},"content":"\u003cp\u003e\u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie\"\u003eDocument Cookie\u003c/a\u003e is a part of the HTML Document. It's used on many, if not most, websites to store data.\nAlthough, \u003ccode\u003edocument.cookie\u003c/code\u003e is a string, there are subtle nuances to its API which can be misunderstood.\nIn this article, these nuances are explored in \u003cem\u003ejust enough\u003c/em\u003e detail to, hopefully, make \u003ccode\u003edocument.cookie\u003c/code\u003e even more understandable.\u003c/p\u003e\n\u003ch2\u003eThe Basics of Document Cookie\u003c/h2\u003e\n\u003cp\u003eCookies can be created or referenced via the \u003ccode\u003edocument.cookie\u003c/code\u003e property.\u003c/p\u003e\n\u003cp\u003eTo create a cookie, all that is needed is something very simple.\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\u0026#x3C;key\u003e=\u0026#x3C;value\u003e;'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eReading cookies is very simple as well.\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e cookies \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUrlSearchParams\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003ereplaceAll\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'; '\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\u0026#x26;'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003ecookies\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eget\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'\u0026#x3C;key\u003e'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch2\u003eCookie Attributes Are Write Only (Nuance 1)\u003c/h2\u003e\n\u003cp\u003eAfter reading \"The Basics of Document Cookie\" section above, Cookies are incredibly simple to understand.\nHowever, if viewing \u003ca href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/cookie\"\u003eMDN's\u003c/a\u003e description of \u003ccode\u003edocument.cookie\u003c/code\u003e, you'll notice attributes can be added to a cookie to control its behavior.\nThis concept is easy to understand. However, when viewing the API for adding attributes, it's slightly more confusing.\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\u0026#x3C;key1\u003e=value1; expires=\u0026#x3C;date1\u003e; path=\u0026#x3C;path\u003e; domain=\u0026#x3C;domain\u003e; secure; httponly'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\u0026#x3C;key2\u003e=value2; expires=\u0026#x3C;dat2\u003e; path=\u0026#x3C;path\u003e;secure; httponly'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e cookies \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUrlSearchParams\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token known-class-name class-name\"\u003eObject\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003efromEntries\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003ecookies\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// { key1: 'value1', key2: 'value2' }\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eCode Observations\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eWhen reading the cookie output, all attributes are removed\u003c/li\u003e\n\u003cli\u003eEach cookie only has an accessible \u003ccode\u003ekey\u003c/code\u003e and \u003ccode\u003evalue\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eBrowser Observation\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eCookie attributes can be viewed in the browser only!\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003eCookie Updates (Nuance 2)\u003c/h2\u003e\n\u003cp\u003eHint, a Cookie cannot be updated. It can only be re-written!\nThe good news is that because a cookie is only a string containing a key and value separated by a \u003ccode\u003e=\u003c/code\u003e, it is easy to find a replace with code.\u003c/p\u003e\n\u003cp\u003eLets see this in in action!\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token keyword\"\u003econst\u003c/span\u003e cookies \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token keyword\"\u003enew\u003c/span\u003e \u003cspan class=\"token class-name\"\u003eUrlSearchParams\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// '\u0026#x3C;key1\u003e=\u0026#x3C;value`\u003e;\u0026#x3C;key2\u003e=\u0026#x3C;value2\u003e;'\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003ecookies\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eset\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token string\"\u003e'\u0026#x3C;key\u003e'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\u0026#x3C;value\u003e'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token comment\"\u003e// note: when adding attributes the code  to update a cookie is slightly more complex\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eCode Observation\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eCookies can't be updated. They can be re-written!\u003c/li\u003e\n\u003cli\u003eIt is important to remember when re-writing a cookie to set necessary attributes!\u003c/li\u003e\n\u003cli\u003eIt is important when designing the tech spec of a cookie to plan for attributes being write-only!\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eBrowser Obverations\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eWhen viewing \u003ccode\u003ecookies\u003c/code\u003e assigned to \u003ccode\u003edocument.cookie\u003c/code\u003e in a string, \u003ccode\u003eattributes\u003c/code\u003e are removed\u003c/li\u003e\n\u003cli\u003eCookie key and value pairs are separated by a \u003ccode\u003e=\u003c/code\u003e within the \u003ccode\u003ecookies\u003c/code\u003e string.\u003c/li\u003e\n\u003cli\u003eCookies are separated by a \u003ccode\u003e;\u003c/code\u003e with the \u003ccode\u003ecookies\u003c/code\u003e string\u003c/li\u003e\n\u003c/ul\u003e\n\u003chr\u003e\n\u003ch2\u003eAdding Multiple Cookies (Nuance 3)\u003c/h2\u003e\n\u003cp\u003eWhen retrieving cookies, executing \u003ccode\u003econsole.log(document.cookie)\u003c/code\u003e  will print all of the cookies on the document as key value pairs. In that same space, it isn’t far fetched to think multiple cookies could be added the same way—\u003ccode\u003edocument.cookie='foo=bar; biz=baz;'\u003c/code\u003e. However, that could will only assign the first cookie.\u003c/p\u003e\n\u003cp\u003eTo add multiple cookies, each cookie must be added in a separate \u003ccode\u003edocument.cookie\u003c/code\u003e assignment like the code block below.\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003ekey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'foo'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003evalue\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'bar'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003ekey\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'biz'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e \u003cspan class=\"token literal-property property\"\u003evalue\u003c/span\u003e\u003cspan class=\"token operator\"\u003e:\u003c/span\u003e \u003cspan class=\"token string\"\u003e'baz'\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token method function property-access\"\u003eforEach\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token parameter\"\u003e\u003cspan class=\"token punctuation\"\u003e{\u003c/span\u003e key\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e value \u003cspan class=\"token punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token arrow operator\"\u003e=\u003e\u003c/span\u003e \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token template-string\"\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003ekey\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e=\u003c/span\u003e\u003cspan class=\"token interpolation\"\u003e\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e${\u003c/span\u003evalue\u003cspan class=\"token interpolation-punctuation punctuation\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token string\"\u003e;\u003c/span\u003e\u003cspan class=\"token template-punctuation string\"\u003e`\u003c/span\u003e\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// 'foo=bar; biz=baz;'\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eCode Observation\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eAdd cookies one at a time with the \u003ccode\u003edocument.cookie=\"\u0026#x3C;key\u003e=\u0026#x3C;value\u003e;\"\u003c/code\u003e assignment\u003c/li\u003e\n\u003cli\u003eRead cookies all at the same time by logging \u003ccode\u003edocument.cookie\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eEach cookie must be added by assigning a key value pair to \u003ccode\u003edocument.cookie\u003c/code\u003e\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eReading Multiple Added Cookies (Nuance 4)\u003c/h2\u003e\n\u003cp\u003eWhen assigning a cookie, attributes are added with the same value as the key and value pair \u003ccode\u003e=\u003c/code\u003e, and \u003ccode\u003e;\u003c/code\u003e.\nWeirdly, when retrieving cookies, each cookie represented by a key and value pair is also seperated by a \u003ccode\u003e=\u003c/code\u003e, and a \u003ccode\u003e;\u003c/code\u003e.\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'\u0026#x3C;key1\u003e=\u0026#x3C;value1\u003e; expires=\u0026#x3C;date1\u003e; path=\u0026#x3C;path\u003e; domain=\u0026#x3C;domain\u003e; secure; httponly'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e\u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// '\u0026#x3C;key1\u003e=\u0026#x3C;value1\u003e;'\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eCode Observation\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eDon't worry about creating a cookie string with attributes and not being able to filter it among cookies and attributes!\u003c/li\u003e\n\u003cli\u003eDo worry about writing tech spec which accounts for expires to only be re-written, not updated!\u003c/li\u003e\n\u003cli\u003eRemember cookie keys are are unique, in that if you assign a cookie with the same key, it will overwrite the other cookie!\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eDeleting Cookies (Nuance 5)\u003c/h2\u003e\n\u003cp\u003eDeleting cookies is more complicated than expected. In order to delete the cookie, it must be assigned to no value as well as have its \u003ccode\u003eMax-age\u003c/code\u003e set to \u003ccode\u003e-1\u003c/code\u003e. It looks like this \u003ccode\u003edocument.cookie=\"foo=; Max-age=-1;\";\u003c/code\u003e . There is much discussion on Stackoverflow and the internet on the best way to delete cookies. Often the use of the setting the \u003ccode\u003eexpires\u003c/code\u003e attribute to a date in the past is mentioned. However, defining a historical date seems more complex that setting a the Max-age to \u003ccode\u003e-1\u003c/code\u003e.\u003c/p\u003e\n\u003cpre class=\"language-javascript\"\u003e\u003ccode class=\"language-javascript code-highlight\"\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'foo=bar;'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// foo=bar\u003c/span\u003e\n\u003c/span\u003e\u003cspan class=\"code-line\"\u003e  \u003cspan class=\"token dom variable\"\u003edocument\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token property-access\"\u003ecookie\u003c/span\u003e \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token string\"\u003e'foo=; Max-age=-1;'\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token comment\"\u003e// empty\u003c/span\u003e\n\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch3\u003eCode Observation\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eDelete cookies by assigning the cookie value to nothing and setting the Max-age or expires\u003c/li\u003e\n\u003cli\u003e\u003ccode\u003eMax-age\u003c/code\u003e looks like a cleaner way to delete cookies vs \u003ccode\u003eexpires\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eDeleting cookies is can only be done 1 at a time, just like adding cookies\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3\u003eBrowser Observations\u003c/h3\u003e\n\u003cul\u003e\n\u003cli\u003eIf you only set the cookie value to empty (\u003ccode\u003edocument.cookie = \"foo=;\";\u003c/code\u003e) (and don't set a Max-age or expires), the cookie will still display in the browser, but without value\u003c/li\u003e\n\u003cli\u003eIf you set the cookie value to empty and set the max-age to -1, the cookie will not display in the browser and will be deleted completely (\u003ccode\u003edocument.cookie = \"foo=;max-age=-1;\";\u003c/code\u003e)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch2\u003eFinal thoughts\u003c/h2\u003e\n\u003cp\u003eCookies are a very simple useful way to store data.\nThe fact that they are write-only and can't be updated is important to understand.\nOnce those 2 points are understood, using cookies should be fun and generally easy.\nLastely, attributes are valuable for managing cookie behavior and keeping them secure!\nJust remember they're only viewable in a browser's dev tools.\u003c/p\u003e\n\u003chr\u003e\n\u003cp\u003eBefore writing this post, I did get caught up in the nuances I have tried to describe in this article.\nI always used \u003ca href=\"https://github.com/js-cookie/js-cookie\"\u003ejs-cookie\u003c/a\u003e or similar so the nuances of \u003ccode\u003edocument.cookie\u003c/code\u003e were hidden.\nI wrote this simple utility, \u003ca href=\"https://github.com/yowainwright/mini-cookies\"\u003emini-cookies\u003c/a\u003e with 0 dependencies to abstract these nuaces—but in a very mimimal way.\nPlease reach out if you have suggestions!\u003c/p\u003e\n\u003cp\u003eHappy Hacking!\u003c/p\u003e","slug":"document-cookie-nuances"},"__N_SSG":true},"page":"/[slug]","query":{"slug":"document-cookie-nuances"},"buildId":"jrpvR4j_iVgWgcGavtFzw","assetPrefix":".","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>